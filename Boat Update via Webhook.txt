alias: BoatIOT Update Data From Webhook
description: ""
triggers:
  - trigger: webhook
    allowed_methods:
      - POST
      - PUT
    local_only: false
    webhook_id: YOUR WEBHOOK ID
conditions:
  - condition: template
    enabled: true
    value_template: >
      {{ trigger.json.token | string | trim == "YOUR SECURITY TOKEN"
      | string | trim }}
    alias: Check for token
actions:
  - alias: Thrillfishing Temp
    if:
      - condition: template
        value_template: >-
          {{ (trigger.json.temp | float(default=0)) == (trigger.json.temp |
          float(default=0)) }}
        enabled: true
    then:
      - data:
          value: "{{ trigger.json.temp }}"
        target:
          entity_id: input_number.thrillfishing_temp
        action: input_number.set_value
        enabled: true
    enabled: true
  - alias: Thrillfishing Voltage2
    if:
      - condition: template
        value_template: >-
          {{ (trigger.json.voltage2 | float(default=0)) ==
          (trigger.json.voltage2 | float(default=0)) }}
        enabled: true
    then:
      - data:
          value: "{{ trigger.json.voltage2 }}"
        target:
          entity_id: input_number.thrillfishing_voltage2
        action: input_number.set_value
  - alias: Thrillfishing Voltage
    if:
      - condition: template
        value_template: >-
          {{ (trigger.json.voltage | float(default=0)) == (trigger.json.voltage
          | float(default=0)) }}
        enabled: true
    then:
      - data:
          value: "{{ trigger.json.voltage }}"
        target:
          entity_id: input_number.thrillfishing_voltage
        action: input_number.set_value
  - if:
      - condition: template
        value_template: >-
          {{ (trigger.json.current | float(default=0)) == (trigger.json.current
          | float(default=0)) }}
    then:
      - data:
          value: "{{ trigger.json.current }}"
        target:
          entity_id: input_number.thrillfishing_current
        action: input_number.set_value
    alias: Thrillfishing Current
  - if:
      - condition: template
        value_template: >-
          {{ (trigger.json.esptemp | float(default=0)) == (trigger.json.esptemp
          | float(default=0)) }}
    then:
      - data:
          value: "{{ trigger.json.esptemp }}"
        target:
          entity_id: input_number.thrillfishing_esp_temp
        action: input_number.set_value
    alias: Thrillfishing ESP Temp
    enabled: true
  - if:
      - condition: template
        value_template: >-
          {{ (trigger.json.uptime | float(default=0)) == (trigger.json.uptime |
          float(default=0)) }}
    then:
      - data:
          value: "{{ trigger.json.uptime }}"
        target:
          entity_id: input_number.boat_uptime
        action: input_number.set_value
    alias: Thrillfishing Uptime
    enabled: false
  - alias: Thrillfishing Bilge Alarm
    if: []
    then:
      - action: input_text.set_value
        data:
          value: "{{ trigger.json.bilgealarm }}"
        target:
          entity_id: input_text.bilge_alarm
    enabled: true
  - target:
      entity_id: input_text.boat_wifi
    data:
      value: "{{ trigger.json.get('wifi', 'No WiFi data') }}"
    action: input_text.set_value
    enabled: true
  - metadata: {}
    data:
      datetime: "{{ now() }}"
    target:
      entity_id:
        - input_datetime.boat_last_run
    action: input_datetime.set_datetime
mode: single
